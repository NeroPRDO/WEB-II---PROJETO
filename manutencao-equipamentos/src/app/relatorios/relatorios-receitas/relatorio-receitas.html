<div class="relatorio-wrapper">
  <section class="card filtros">
    <h2>RF019 — Relatório de Receitas (por período)</h2>
    <div class="row">
      <div class="col">
        <label>Data inicial</label>
        <input type="date" [(ngModel)]="inicio">
      </div>
      <div class="col">
        <label>Data final</label>
        <input type="date" [(ngModel)]="fim">
      </div>
      <div class="col actions">
        <button class="btn primary" (click)="onFiltrar()">Filtrar</button>
        <button class="btn sec" (click)="onLimpar()">Limpar</button>
        <button class="btn print" (click)="gerarPDF()">Gerar PDF</button>
      </div>
    </div>
    <p class="hint">Deixe as datas em branco para considerar “desde sempre”.</p>
  </section>

  <section class="card tabela" id="print-area">
    <h3>Receitas agrupadas por dia</h3>

    <div *ngIf="carregado && linhas.length === 0" class="empty">
      <p>Nenhum registro encontrado no período informado.</p>
    </div>

    <div *ngFor="let linha of linhas" class="day-block">
      <div class="day-header">
        <strong>{{ linha.day }}</strong>
        <span class="total-dia">Total do dia: R$ {{ linha.total | number:'1.2-2' }}</span>
      </div>
      <table class="tbl">
        <thead>
          <tr>
            <th>Horário</th>
            <th>Categoria</th>
            <th>Descrição</th>
            <th class="num">Valor (R$)</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let r of linha.itens">
            <td>{{ (r.dataIso | date:'shortTime') }}</td>
            <td>{{ r.categoria }}</td>
            <td>{{ r.descricao || '-' }}</td>
            <td class="num">{{ r.valor | number:'1.2-2' }}</td>
          </tr>
        </tbody>
      </table>
    </div>

    <div *ngIf="linhas.length" class="footer-total">
      <strong>Total geral: R$ {{ totalGeral() | number:'1.2-2' }}</strong>
    </div>
  </section>
</div>
