<app-nav></app-nav>

<div class="container m-top">
    <div class="row justify-content-center painel-funcionario">
        <div class="col-3">
            <painel-acoes-funcionario />
        </div>
        <div class="col-8">
            <panel>
                <h3 class="text-center">Chamados Abertos</h3>

                <div class="filtros-chamados">
                    <span>Mostrar</span>
                    <select class="form-select form-select-sm" aria-label="Small select example">
                        <option value="1">Todas</option>
                        <option value="1">Abertas Hoje</option>
                        <option value="2">Periodo</option>
                    </select>
                </div>
                <ng-template #templateEditar let-row let-emitter="emitter">
                    <div class="template-center">

                        @switch (row.estado) {

                        @case ('ABERTA') {
                        <button class="btn btn-verde" (click)="abrirModalOrcamento(row)">
                            Orçar
                        </button>
                        }

                        @case ('AGUARDANDO_APROVACAO') {
                        <button class="btn btn-amarelo" (click)="verDetalhes(row)">
                            Ver Detalhes
                        </button>
                        }

                        @case ('EM_MANUTENCAO') {
                        <button class="btn btn-azul" (click)="finalizarManutencao(row)">
                            Finalizar
                        </button>
                        }

                        @case ('REJEITADA') {
                        <span class="texto-cinza">Rejeitado</span>
                        }
                        @case ('CONCLUIDA') {
                        <span class="texto-verde">Concluído</span>
                        }

                        @default {
                        <button class="btn btn-branco" (click)="emitter.emit(row)">
                            Editar
                        </button>
                        }
                        }

                    </div>
                </ng-template>
                <ng-template #templateCodigo let-row>
                    <div class="template-center">
                        {{ row.codigo }}
                    </div>
                </ng-template>
                <app-table-chamado (action)="openOrcamentoModal($event)" [colunas]="[
                    { id: 'cliente', header: 'CLIENTE'},
                    { id: 'estado', header: 'ESTADO',  headerStyle: 'col-2'},
                    { id: 'descricao', header: 'DESCRIÇÃO'},
                    { id: 'data_chamado', header: 'DATA', headerStyle: 'col-2'},
                    { id: 'acao', header: 'AÇÃO', render: templateEditar, headerStyle: 'col-2 text-center'}
                ]" [data]="chamadosFiltrados" />
            </panel>
        </div>
    </div>


</div>

@if (orcamentoModalVisible) {
<app-efetuar-orcamento (close)="closeOrcamentoModal()" [id]="selectedChamado"></app-efetuar-orcamento>
}