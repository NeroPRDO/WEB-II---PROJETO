<app-nav></app-nav>

<div class="container m-top">
    <div class="row justify-content-center painel-funcionario">
        <div class="col-3">
            <painel-acoes-funcionario />
        </div>
        <div class="col-8">
            <panel>
                <div class="title-row">
                    <h3 class="">Categorias</h3>
                    <button (click)="openAdicionarCategoria()" class="btn btn-verde">Adicionar</button>
                </div>
                <ng-template #templateEditar let-row let-emitter="emitter">
                    <div class="template-center">
                        <button class="btn btn-branco" (click)="emitter.emit(row)">editar</button>
                    </div>
                </ng-template>

                <ng-template #templateAtivo let-row>
                    <div class="template-center">
                        @if (row.ativo) {
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                            <path
                                d="M23.334 11.96c-.713-.726-.872-1.829-.393-2.727.342-.64.366-1.401.064-2.062-.301-.66-.893-1.142-1.601-1.302-.991-.225-1.722-1.067-1.803-2.081-.059-.723-.451-1.378-1.062-1.77-.609-.393-1.367-.478-2.05-.229-.956.347-2.026.032-2.642-.776-.44-.576-1.124-.915-1.85-.915-.725 0-1.409.339-1.849.915-.613.809-1.683 1.124-2.639.777-.682-.248-1.44-.163-2.05.229-.61.392-1.003 1.047-1.061 1.77-.082 1.014-.812 1.857-1.803 2.081-.708.16-1.3.642-1.601 1.302s-.277 1.422.065 2.061c.479.897.32 2.001-.392 2.727-.509.517-.747 1.242-.644 1.96s.536 1.347 1.17 1.7c.888.495 1.352 1.51 1.144 2.505-.147.71.044 1.448.519 1.996.476.549 1.18.844 1.902.798 1.016-.063 1.953.54 2.317 1.489.259.678.82 1.195 1.517 1.399.695.204 1.447.072 2.031-.357.819-.603 1.936-.603 2.754 0 .584.43 1.336.562 2.031.357.697-.204 1.258-.722 1.518-1.399.363-.949 1.301-1.553 2.316-1.489.724.046 1.427-.249 1.902-.798.475-.548.667-1.286.519-1.996-.207-.995.256-2.01 1.145-2.505.633-.354 1.065-.982 1.169-1.7s-.135-1.443-.643-1.96zm-12.584 5.43l-4.5-4.364 1.857-1.857 2.643 2.506 5.643-5.784 1.857 1.857-7.5 7.642z" />
                        </svg>
                        } @else {
                        <svg clip-rule="evenodd" width="24" height="24" fill-rule="evenodd" stroke-linejoin="round"
                            stroke-miterlimit="2" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="m12 10.93 5.719-5.72c.146-.146.339-.219.531-.219.404 0 .75.324.75.749 0 .193-.073.385-.219.532l-5.72 5.719 5.719 5.719c.147.147.22.339.22.531 0 .427-.349.75-.75.75-.192 0-.385-.073-.531-.219l-5.719-5.719-5.719 5.719c-.146.146-.339.219-.531.219-.401 0-.75-.323-.75-.75 0-.192.073-.384.22-.531l5.719-5.719-5.72-5.719c-.146-.147-.219-.339-.219-.532 0-.425.346-.749.75-.749.192 0 .385.073.531.219z" />
                        </svg>
                        }
                    </div>
                </ng-template>

                <ng-template #templateNome let-row>
                    <div class="template-nome template-center">
                        {{ row.nomeCategoria }}
                    </div>
                </ng-template>
                <ng-template #templateCodigo let-row>
                    <div class="template-center">
                        {{ row.id }}
                    </div>
                </ng-template>
                <app-table-chamado (action)="openEditarCategoria($event)" [colunas]="[
                    { id: 'id', header: 'ID', render: templateCodigo, headerStyle: 'col-2 text-center' },
                    { id: 'nomeCategoria', header: 'Nome' },
                    { id: 'ativo', header: 'Ativo', render: templateAtivo, headerStyle: 'col-2 text-center' },
                    { id: 'acao', header: 'Ação', render: templateEditar, headerStyle: 'col-2 text-center'}
                    ]" [data]="data" />
            </panel>
        </div>
    </div>
    @if (modalEditarCategoriaVisible) {
    <app-modal (closeModalEvent)="closeEditarCategoria()">
        <h4>Editar Categoria</h4>

        <form [formGroup]="updateCatForm" (ngSubmit)="updateCategoria()">
            <div class="fundo-modal gap p-4 bg-gray-50 rounded-lg shadow-inner">
                <div class="flex flex-col gap-2 mb-4">
                    <span>Nome</span>
                    <input class="base-input" formControlName="nomeCategoria">
                </div>
                <div class="flex items-center gap-2">
                    <input type="checkbox" id="updateAtivo" formControlName="ativo"
                        class="h-4 w-4 text-green-600 rounded focus:ring-green-500">
                    <label for="updateAtivo">Ativo</label>
                </div>
            </div>
            <div class="btn-div p-top">
                <button (click)="openRemoverCategoria()" type="button" class="btn btn-vermelho">remover</button>
                <button type="submit" class="btn btn-verde">salvar</button>
            </div>
        </form>
    </app-modal>
    }

    @if (modalRemoverCategoriaVisible) {
    <app-modal (closeModalEvent)="closeRemoverCategoria()">
        <h3>Remover Categoria?</h3>
        <p>Tem certeza que deseja remover a categoria "{{ selectedCategoria!.nomeCategoria }}"?</p>
        <div class="btn-div">
            <button (click)="removeCategoriaByID(selectedCategoria!.id)" class="btn btn-vermelho">remover</button>
            <button (click)="closeRemoverCategoria()" class="btn btn-verde">cancelar</button>
        </div>
    </app-modal>
    }

    @if (modalAdicionarCategoriaVisible) {

    <app-modal (closeModalEvent)="closeAdicionarCategoria()">
        <h4>Adicionar Categoria</h4>

        <form [formGroup]="addCatForm" (ngSubmit)="addCategoria()">
            <div class="fundo-modal gap p-4 bg-gray-50 rounded-lg shadow-inner">
                <div class="flex flex-col gap-2 mb-4">
                    <span>Nome</span>
                    <input class="base-input" formControlName="nomeCategoria">
                </div>
                <div class="flex items-center gap-2">
                    <input type="checkbox" id="addAtivo" formControlName="ativo"
                        class="h-4 w-4 text-green-600 rounded focus:ring-green-500">
                    <label for="addAtivo">Ativo</label>
                </div>
            </div>
            <div class="btn-div p-top">
                <button (click)="closeAdicionarCategoria()" type="button" class="btn btn-vermelho">cancelar</button>
                <button type="submit" class="btn btn-verde" [disabled]="!addCatForm.valid">salvar</button>
            </div>
        </form>
    </app-modal>
    }

</div>